<vex-page-layout>
  <vex-page-layout-header class="pb-16" fxLayout="column" fxLayoutAlign="center start">
    <div class="w-full flex flex-col sm:flex-row justify-between">
      <div>
        <h1 class="title mt-0 mb-1">Transactions Details</h1>
        <vex-breadcrumbs [crumbs]="['Dashboard', 'Transactions', 'Transaction-details']"></vex-breadcrumbs>
      </div>

    </div>
  </vex-page-layout-header>

  <vex-page-layout-content [class.container]="true" [class.px-gutter]="true" class="-mt-16">

    <div class="grid grid-cols-2 md:grid-cols-6">
      <div>
        <div class="ml-4">
          <img class="block w-6 h-6 rounded-full" [src]="buyerPhototURL" />
        </div>
      </div>
      <div>
        <div class="-mx-32">
          <span class="text-xs text-gray-300">{{ transactionDetails?.initiator_name }}
            {{ transactionDetails?.initiator_first_name }}</span>
        </div>
        <div class="grid mt-6  grid-flow-col grid-cols-2 grid-rows-1 gap-8">
          <div class="phoneIcone">
            <ic-icon [icIcon]="icPhone" size="20px"></ic-icon>
          </div>
          <div class="-mx-32 -mt-4 phoneNumber">
            <span class="text-xs text-gray-300">
              {{ transactionDetails?.initiator_phone }}
            </span>
          </div>
        </div>
      </div>
      <div>
        <div class="grid grid-flow-col grid-cols-2 grid-rows-1 mt-4">
          <div class="-ml-12 mt-4">
            <ic-icon [icIcon]="icMap" size="20px"></ic-icon>
          </div>
          <div class="-ml-10 mt-2" style="margin-top: 13px">
            <span class="text-xs text-gray-300">
              {{ transactionDetails?.initiator_address }}
            </span>
          </div>
        </div>
      </div>
      <div>
        <div class="grid grid-flow-col grid-cols-2 grid-rows-1 mt-12">
          <div class="-ml-4 -mt-4">
            <ic-icon [icIcon]="icEmail" size="20px"></ic-icon>
          </div>
          <div class="-ml-6 -mt-4">
            <span class="text-xs text-gray-300">
              {{ transactionDetails?.initiator_email }}
            </span>
          </div>
        </div>
      </div>
      <div>
        <div class="grid grid-cols-3 col-end-7 total">
          <div class="mt-2">
            <ic-icon [icIcon]="icLock" size="20px"></ic-icon>
          </div>
          <div class="-ml-6 mt-2 price">
            <h3 class="text-md text-gray-300">
              {{ transactionDetails?.price }}
              {{ transactionDetails?.currency }}
            </h3>
          </div>
          <div *ngIf="!isCancelled" (click)="openDialog()" class="mt-2 priceIcon">
            <ic-icon style="color: rgb(197, 55, 55); cursor: pointer" [icIcon]="icCancel" size="20px"></ic-icon>
          </div>
        </div>
      </div>

    </div>

    <div class="grid grid-rows-3 grid-flow-col mt-2">
      <div class=" row-span-2">
        <div class='row-span-4'>
          <div class="grid grid-cols-3 pb-9 p-6 bg-white  ">
            <div class="col-span-2">
              <div class="flex mt-4 ml-2">
                <div class="grid grid-flow-col grid-cols-1">
                  <ic-icon class="text-red " [icIcon]="icInfo" size="20px"></ic-icon>
                  <p class="text-xs text-gray-300 text-red dark:bg-red  ml-4">
                    This transaction can only be cancelled by you
                  </p>
                </div>
              </div>
              <div class="flex mt-4 ml-2">
                <div class="grid grid-flow-col grid-cols-1">
                  <ic-icon class="text-red" [icIcon]="icInfo" size="20px"></ic-icon>
                  <p class="text-xs  text-gray-300 text-red  ml-8">
                    Custumer must acknowledge receipe of goods with the delivery
                    code this will release the money to your account
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <hr class="mt-4 bg-gray h-0.90 w-900" />
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 w-full  mt-4 px-7" matSort>
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef>Item ID</th>
            <td mat-cell *matCellDef="let item">
              {{ item?.item_id }}
            </td>
          </ng-container>
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Item name</th>
            <td mat-cell *matCellDef="let item">
              {{ item?.name }}
            </td>
          </ng-container>
          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef>Desription</th>
            <td mat-cell *matCellDef="let item">
              {{ item?.description }}
            </td>
          </ng-container>
          <ng-container matColumnDef="qty">
            <th mat-header-cell *matHeaderCellDef>Quantity</th>
            <td mat-cell *matCellDef="let item">{{ item?.items_qty }}</td>
          </ng-container>
          <ng-container matColumnDef="total">
            <th mat-header-cell *matHeaderCellDef>Total</th>
            <td mat-cell *matCellDef="let item">
              {{ transactionDetails?.price }}
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="4">No data Data Found!</td>
          </tr>
        </table>
        <div>

        </div>
        <div class="grid grid-cols-2 text-left mt-2">
          <div>
            <h6 class="ml-4">Amount secured</h6>
          </div>
          <div class="totalT">
            <ic-icon style="color: rgb(75, 75, 214)" [icIcon]="icLock" size="20px"></ic-icon>
            <h6 class="text-center">
              {{ transactionDetails?.price }}
              {{ transactionDetails?.currency }}
            </h6>
          </div>
        </div>

      </div>
      <div class="row-span-2">
        <div class="h-64 grid grid-rows-2 grid-flow-col gap-4">
          <div>
            <div>
              <h6 class="text-center w-100  ">
                Delivery code confirmation
              </h6>
              <div>
                <h3 class="text-center w-100 mt-10">
                  {{ transactionDetails?.release_code }}
                </h3>
              </div>
            </div>
          </div>
          <div>
            <div>
              <h6 class="text-center w-100">Dispatch Rider contact</h6>
              <p class="text-center text-gray-300 text-xs w-100">
                Every time you will change the dispatch rider,the
                custumer will get modified
              </p>
            </div>
            <div [formGroup]="form" *ngIf="displayPhoneInput" class=" mt-4"
              style="width: 20px;position: relative;left: 36px;">
              <p>
                <mat-form-field appearance="legacy">
                  <input matInput type="text" formControlName="newDeliveryNo" />
                  <span matPrefix>{{ prefixCountryCode }}</span>
                  <mat-error *ngIf="form?.status === 'INVALID'">Please enter a valid phone number
                  </mat-error>
                </mat-form-field>
              </p>
              <div>
                <button mat-raised-button style="width: 180px" color="primary" (click)="updateDeliveryPhone()"
                  [disabled]="form?.status === 'INVALID'">
                  Change
                </button>
              </div>
            </div>

            <div class="grid grid-flow-col grid-cols-1 text-center mt-4" *ngIf="!displayPhoneNumber">
              <h5 class="text-md mr-8 text-gray-300"> {{ transactionDetails?.delivery_phone }}</h5>
              <ic-icon [icIcon]="icEdit" (click)="onDisplayInput()"
                style="cursor: pointer; color: rgb(75, 75, 214);position: relative;left: -70px;" size="20px"></ic-icon>
            </div>
          </div>
        </div>
      </div>
    </div>

  </vex-page-layout-content>
</vex-page-layout>